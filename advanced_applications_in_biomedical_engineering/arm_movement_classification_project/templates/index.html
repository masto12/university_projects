<!DOCTYPE html>
<html>
    <head>
    	<meta charset="utf-8">
    	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
		<meta name="description" content="Sync is a landing page HTML template built with Bootstrap 4 for presenting mobile apps to the online audience and for getting visitors to become users.">
    	<meta name="author" content="Inovatik">

        <title>Arm Movement Classification</title>
        
        <link href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700&display=swap&subset=latin-ext" rel="stylesheet">
    	<link href="{{ url_for('static', filename='css/bootstrap.css')}}" rel="stylesheet">
    	<link href="{{ url_for('static', filename='css/fontawesome-all.css')}}" rel="stylesheet">
    	<link href="{{ url_for('static', filename='css/swiper.css')}}" rel="stylesheet">
		<link href="{{ url_for('static', filename='css/magnific-popup.css')}}" rel="stylesheet">
		<link href="{{ url_for('static', filename='css/styles.css')}}" rel="stylesheet">

    </head>
    
    <header class="header">
        <div class="container">
            <div class="row">
                <div class="col-lg-12">
                    <div class="text-container">
                        <h1>Arm Movement Classification</h1>
                        <p class="p-large p-heading">Prediction Model for Adduction, Adbuction, Extension, Flexion, Pronation and Supination
						with SensorStreamer</p>
						
						<p class="p-large p-heading"> Press start and conduct arm movement during the next 6 seconds </p>
						
						<form style='height:5%'>
							Virtual Machine IP:<br>
							<input style:'display:inline' type="text" value='' id='VmIP'>
							<input style:'display:inline' type="button" onclick=VMConnect() value="Start!">
						</form>
						
						<form style='height:5%'>
			 				Predicted arm movement:<br>
							<input type="text" name="Result" id='result' readonly>
						</form>
						
						<form style= 'height:5%'>
						    Time elapsed:<br>
						    <input type="text" name="Time" id='time' readonly>
						</form>

                    </div> <!-- end of text-container -->
                </div> <!-- end of col -->
            </div> <!-- end of row -->
            <div class="row">
                <div class="col-lg-12">
                    <div class="image-container">
                        <img class="img-fluid" src="{{ url_for('static', filename='/images/header-iphone.png')}}" alt="alternative">
                    </div> <!-- end of text-container -->
                </div> <!-- end of col -->
            </div> <!-- end of row -->
        </div> <!-- end of container -->
        <div class="deco-white-circle-1">
            <img src="{{ url_for('static', filename='/images/decorative-white-circle.svg')}}" alt="alternative">
        </div> <!-- end of deco-white-circle-1 -->
        <div class="deco-white-circle-2">
            <img src="{{ url_for('static', filename='/images/decorative-white-circle.svg')}}" alt="alternative">
        </div> <!-- end of deco-white-circle-2 -->
        <div class="deco-blue-circle">
            <img src="{{ url_for('static', filename='/images/decorative-blue-circle.svg')}}" alt="alternative">
        </div> <!-- end of deco-blue-circle -->
        <div class="deco-yellow-circle">
            <img src="{{ url_for('static', filename='/images/decorative-yellow-circle.svg')}}" alt="alternative">
        </div> <!-- end of deco-yellow-circle -->
        <div class="deco-green-diamond">
            <img src="{{ url_for('static', filename='/images/decorative-green-diamond.svg')}}" alt="alternative">
        </div> <!-- end of deco-yellow-circle -->
    </header>


    <body>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.1/socket.io.js" integrity="sha512-q/dWJ3kcmjBLU4Qc47E4A9kTB4m3wuTY7vkFJDTZKjTs8jhyGQnaUrxa0Ytd0ssMZhbNua9hE+E7Qv1j+DyZwA==" crossorigin="anonymous"></script>

        <script type="text/javascript" charset="utf-8">
            // To help you connecting to the VM, the input form value is populated automatically using the current URL.
			window_url = window.location.href.split(':')[1].substring(2)
			document.getElementById("VmIP").value = window_url
			
			document.getElementById("result").value = "Waiting for result..."

			function VMConnect(){

            // Initialize the socket
            var socket = io(document.getElementById("VmIP").value + ':5000/');
            var interval = null;

            // This function is called after the socket is initiated
            socket.on('connect', function() {
              socket.emit('sendData', JSON.stringify({type:'sendData'}))
              console.log("DEBUG: A sendData request was sent to the server.");
            });

            socket.on('serverResponse', function(msg) {
          // View result data generated by Python script
	      document.getElementById("result").value = msg.result
	      document.getElementById("time").value = msg.time
            });

            // This handles any error, like connection drops.
            socket.on('connect_error', function (event) {
                alert('Can not connect to the server.\nIs the Virtual Machine IP correct?\nIs the server running?\nAre you connect to the correct Wi-Fi network?');
                console.log('Loss of connection event');
                clearInterval(interval);
                socket.close();
                });

            }
        </script>
    </body>
</html>
